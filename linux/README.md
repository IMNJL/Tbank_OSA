# Практика_Linux

Данное задание направлено на обучение типовым командам в командной строке Linux. В рамках практики по виртуализации мы установили виртуальную машину с образом Ubuntu под VirtualBox.

---

Теперь на данной виртуальной машине вам необходимо выполнить следующие задания, залогинившись под пользователем `root`:

1. Обновить установленные пакеты через пакетный менеджер `apt`.
2. Дополнительно установить пакеты `vim`, `nano`, `tree` и `traceroute` через пакетный менеджер `apt` (они вам дальше помогут).
3. Создать пользователя с именем `user` и паролем `strongpassword321`.
4. Создать группу с названием `admin` и добавить туда пользователя `user`.
5. Разрешить пользователю `user` выполнять команды от лица суперпользователя, добавив его в группу `sudo` через утилиту `usermod`.
6. Создать и открыть на редактирование файл `/root/nirvana-song.txt`, записать в него текст песни “Smells Like Teen Spirit” группы Nirvana.
7. Создать директорию `/root/new-dir` с правами `740`, установить владельцем созданной директории пользователя `user` и группу `admin`.
8. Создать симлинк (symbolic link) `/usr/local/bin/ls-link` на файл `/bin/ls`, проверить работоспособность.
9. Создать переменную окружения с названием `MY_ENV` и значением `BEST_LINUX_LAB_EVER`.
10. Установить веб-сервер `nginx` через пакетный менеджер `apt` и запустить его (убедиться, что он слушает стандартный порт `80`).
11. Вывести список файлов и каталогов в директории `/etc`, перенаправить (записать) его в файл `/root/etc-directories-list.txt`.
12. Посчитать количество файлов (НЕ каталогов!) в директории `/bin`, перенаправить это число в файл `/root/bin-files-count.txt`.
13. Найти самый большой файл в директории `/etc`, записать абсолютный путь к нему в `/root/biggest-file.txt` (подсказка: поиск нужно выполнить по всем поддиректориям).
14. Создать `cronjob`, которая каждый день один раз в `5:45` утра будет перезагружать (restart) веб-сервер `nginx`.
15. Посчитать количество доступных сетевых интерфейсов, записать их количество (цифру) в файл `/root/interfaces-count.txt`.
16. Написать небольшой shell-скрипт `/root/script.sh`, который создаст ровно `404` пустых файла с разными названиями в директории `/root/404/`, сделать его исполняемым из любой директории (добавить шебанг) и запустить его ровно один раз.
17. Посчитать `md5`-хешсумму от файла `/etc/hosts` и записать её в файл `/root/md5-hosts.txt`.
18. С помощью утилиты `ufw` разрешить входящие соединения только на порты `22`, `80`, `443` и `8080` и запретить на все остальные, а также явно заблокировать весь входящий трафик с хоста `192.168.88.5`.
19. Запустить утилиту `traceroute` до хоста `8.8.4.4`, убедиться, что трафик его достигает, и записать результат выполнения в файл `/root/traceroute.txt`.
20. Сгенерировать пару `ssh`-ключей алгоритмом `RSA` для пользователя `root` (не используя `passphrase`), сохранить их в директорию по умолчанию.
21. Отправить `GET`-запрос к сайту `https://example.com` через `curl`, записать заголовки ответа сервера в файл `/root/example-curl.txt` (найдите опцию утилиты, которая отобразит вам эти заголовки).
22. Проверить количество свободного места на диске в корневом разделе, записать результат в Гб в файл `/root/available-space.txt`, округлив до десятых или до целого числа (например, `17G` или `9,6G`; если русская локаль, то `9.6G`); если места на диске меньше одного Гб, то запишите ответ в Мб (по типу `182M`).
23. Установить `timezone` равным `Asia/Novosibirsk`.

---

По ссылке [https://disk.yandex.ru/d/j9zQGKBHPvah1w](https://disk.yandex.ru/d/j9zQGKBHPvah1w) доступны чекеры для данного задания. Чекер в автоматическом режиме проверит корректность выполнения ваших заданий и озвучит вам оценку.

- Чекер необходимо скачать на виртуалку.
- При скачивании выберите исполняемый файл под свою архитектуру: `x86` или `arm`.
- При запуске чекера нужно указать свои имя и фамилию параметрами командой строки (бинарь сам вам подскажет формат, если вы запустите его с опцией `--help`).
- Запускайте чекер под пользователем `root`, иначе ему может не хватить прав на чтение файлов.
- Мы не ограничивали количество попыток, но большое количество отправок вызовет у нас подозрение и вопросы.
- Пожалуйста, не пересоздавайте виртуалку при выполнении лабы, иначе чекер может отработать некорректно и занизить вашу оценку.

Если у вас упала одна из проверок, но при этом вы уверены, что вы выполнили всё необходимое, то попробуйте выполнить этот шаг ещё раз (возможно, в системе что-то поменялось и вам надо актуализировать информацию для проверки).


# Код выполнения задания

1. Обновление пакетов
```shell
apt update && apt upgrade -y
```

2. Установка дополнительных пакетов
```shell
apt install -y vim nano tree traceroute
```

3. Создание пользователя и группы
```shell
useradd -m -s /bin/bash user
echo "user:strongpassword321" | chpasswd
groupadd admin
usermod -aG admin user
usermod -aG sudo user
```

4. Создание файла с текстом песни
```
echo "Smells Like Teen Spirit" > /root/nirvana-song
vim /root/nirvana-song.txt  # Вставьте текст песни вручную
```

5. Создание директории и установка прав
```
mkdir /root/new-dir
chmod 740 /root/new-dir
chown user:admin /root/new-dir
```

6. Создание симлинка
```
ln -s /bin/ls /usr/local/bin/ls-link
/usr/local/bin/ls-link 
```
 # Проверка

7. Создание переменной окружения
```
echo 'export MY_ENV=BEST_LINUX_LAB_EVER' >> /etc/e
source /etc/environment
```
для проверки - 
```shell
echo $MY_ENV
```

8. Установка и запуск веб-сервера nginx
```
apt install -y nginx
systemctl start nginx
systemctl enable nginx
ss -tuln | grep :80  # Проверка
```

9. Вывод списка файлов из /etc
```shell
ls -l /etc > /root/etc-directories-list.txt
```

10. Подсчет количества файлов в /bin
```shell
find $(realpath /bin) -type f | wc -l > /root/bin-files-count.txt
```

11. Поиск самого большого файла в /etc
```shell
find /etc -type f -exec du -h {} + | sort -rh | head -n 1 | awk '{print $2}' > /root/biggest-file.txt
```

12. Создание cronjob
```shell
(crontab -l 2>/dev/null; echo "45 5 * * * systemctl restart nginx") | crontab -
```

13. Подсчет сетевых интерфейсов
```shell
ls /sys/class/net | wc -l > /root/interfaces-count.txt
```

14. Создание скрипта для 404 файлов
```shell
mkdir /root/404
cat << 'EOF' > /root/script.sh
#!/bin/bash
for i in $(seq 1 404); do
    touch /root/404/file_$i
done
EOF
chmod +x /root/script.sh
/root/script.sh
```

15. MD5-хеш файла /etc/hosts
```shell
md5sum /etc/hosts | awk '{print $1}' > /root/md5-hosts.txt
```

16. Настройка ufw
```
ufw allow 22
ufw allow 80
ufw allow 443
ufw allow 8080
ufw deny from 192.168.88.5
ufw enable
```

17. Traceroute до 8.8.4.4
```shell
traceroute 8.8.4.4 > /root/traceroute.txt
```

18. Создание SSH-ключей
```shell
ssh-keygen -t rsa -N "" -f /root/.ssh/id_rsa
```

19. GET-запрос через curl
```shell
curl -I https://example.com > /root/example-curl.txt
```

20. Проверка свободного места
```shell
LC_ALL=C df -h / | awk 'NR==2 {print $4}' > /root/available-space.txt
```

или округление до целого
```shell
LC_ALL=C df -h / | awk 'NR==2 {printf "%.0fG\n", $4}' > /root/available-space.txt
```

21. Установка часового пояса
```shell
timedatectl set-timezone Asia/Novosibirsk
```


22. Скачивание чекера
```shell
wget -O checker https://disk.yandex.ru/d/j9zQGKBHPvah1w
chmod +x checker
./checker --help
```

23. Запуск чекера
```shell
./checker --name "Ваше Имя" --surname "Ваша Фамилия"
```
